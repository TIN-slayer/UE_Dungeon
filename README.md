Дмитриев Дмитрий  
GameDoc для ДЗ-1 по Unreal

# Введение

Я позволил себе взять несколько вольностей по интерпретации ТЗ, поэтому я пройдусь по его пунктам и расскажу, как я его реализовал и заодно объясню, какой вышел кор и мета геймлуп у игры.

# Интерпретация ТЗ

1. Передвижение и прыжки реализовал  
2. В качестве индикатора здоровья у персонажа есть кол-во монет (money). Но эти монеты также являются финальным счётом для вашего забега. По сюжету вы пытаетесь сбежать из подземелья с как можно большим кол-ом найденных сокровищ, поэтому, если вы их все потеряете, то вы умираете от горечи по вашим потерянным сокровищам (restart). Эта механика напоминает игры серии Соник, где тот, когда получает урон, теряет кольца (очки и жизни в одном флаконе) и при фулл потере колец \- умирает.    
   Ремарка: У игрока есть 2 долгосрочные цели \- сбежать из подземелья (пройти 6-10 комнат) и набрать как можно больше монет.  
   Как можно потерять монеты (жизни):  
   1. Каждую секунду в комнате с ловушками, вы теряете N монет (дырявый мешок с сокровищами у гг), поэтому вам стоит торопиться.  
   2. Если вы получаете урон от ловушки, то вы теряете N% от вашего текущего кол-ва монет, у урона есть нижняя граница, поэтому если у вас мало монет и процент от этого числа очень низкий, вы всё равно получите нормальный урон) Я позже объясню, почему я выбрал такую систему урона от ловушек.  
3. Как я реализовал уровень и комнаты:  
   1. Вы начинаете игру в safe руме, в котором вы можете выбрать в какую комнату с ловушками вы пойдёте: обычную или сложную.  
   2. Пройдя комнату с ловушками, вы получаете награду в виде монет и снова попадаете в сейф рум. Так как монеты являются жизнями игрока, то при прохождении сложной комнаты вы получите значительно больше монет, чем при прохождении обычной, что по сути и является хилкой в сложной комнате.  
   3. Так как финальная цель моей игры не только сбежать из подземелья с ловушками, но и набрать как можно больше монет, я сделал, что игрок всегда может пройти 10 комнат с ловушками, чтобы максимизировать кол-во монет. Но, чтобы соответствовать ТЗ, я сделал, что после прохождения 6 комнат, в сейф руме может заспауниться escape button, который выведет вас из подземелья, т.е. вы успешно закончите игру со всеми набранными вами монетами.  
   4. После прохождения 10 комнат с ловушками или использования escape button вы выбираетесь из подземелья и оказываетесь на поверхности, где вы можете увидеть ваши сокровища на полу (символ окончания игры) и также посмотреть на ваш финальный счёт (кол-во монет), если он вас не устраивает, то вы можете попробовать ещё один забег из подземелья, нажав restart  
   5. Вернёмся к вопросу, почему я выбрал систему урона от ловушек через процент. Если вы хорошо играете и мало теряете монет, то к середине игры, у вас их может быть настолько много, что ловушки вам уже мало вредят, поэтому использование процента для урона, позволяет сохранять их опасность до конца игры.  
4. Реализовал рандомный спаун комнат с ловушками (подробнее о нём в главе ниже) и сделал свою систему баффов и дебаффов.  
5. Ловушки я разделил на немного другие виды (хотя их также можно поделить на статичные и подвижные):  
   1. Активные \- это ловушки которые постоянно или с заданной периодичностью работают. Их представители:  
      1. Маленькие шипы \- платформа с всегда поднятыми маленькими шипами, которую можно перепрыгнуть. Могут спаунится на полу. Статичные.  
      2. Установка со стрелами \- дырявая платформа, которая стреляет стрелами каждые N секунд. Стрелы можно уничтожить выстрелом своей стрелой при попадании. Могут спаунится на стенах и потолку. Подвижные.  
      3. Паутинная нить \- серый куб из “паутинной нити”, который замедляет игрока в нём. Можно уничтожить выстрелом стрелы. Может спаунится на полу. Статичный.  
   2. Триггерные \- это ловушки, которые активируются при контакте. Их представители:  
      1. Большие шипы \- дырявая платформа со скрытыми шипами. Если игрок задевает триггер, то из ловушки быстро выходят большие шипы. Можно обойти, или попробовать затриггереть, не задев шипы, или затриггереть выстрелом стрелы в платформу. Могут спаунится на полу и стенах. Статичный/Подвижный.  
      2. Огненный пол \- на вид обычная платформа, но если игрок заденет триггер, то идёт звуковая сигнализация и через секунду на месте платформы быстро вспыхивает и потухает низкое пламя (в игре выглядит как красная большая платформа), которое по площади больше самой платформы. Можно либо попробовать выбежать из зоны, где будет пламя, либо прыгнуть, чтобы тебя не задел пламя на полу. Может спаунится на полу. Статичный/Подвижный.

   Как вы заметили я упомянул выстрел стрелами \- это мой способ борьбы с ловушками, о нём подробнее позже.

6. Баффы и дебаффы я реализовал в виде предметов, которые можно подобрать в сейф руме, а не в комнате с ловушками. Бафф я назвал Blessing. Перед входом в комнату с ловушками вы можете взять blessing \- это даст вам рандомную способность на следующую комнату, но вам придётся потратить N монет. Как работает способность: в любой момент во время прохождения комнаты с ловушками вы можете нажать ПКМ и активировать способность, которая даст вам положительный эффект на N секунд. После активации способности, она тратится. Если вы не потратите blessing в следующей же комнате, то он пропадает.  
   Способности от blessings:  
   1. Light-Footed \- временно отключает триггеры для больших шипов и огненного пола То есть по ним можно идни, не активируя их.  
   2. EMP \- временно отключает срелы (эти ловушки перестают стрелять) и маленькие шипы (маленькие шипы прячутся в ловушку на время способности).  
7. Дебафф я назвал Curse. Предмет curse даёт рандомный дебафф на протяжении всей следующей комнаты с ловушками, но взамен вы получаете N монет.   
   Возможные дебаффы:  
   1. Замедление скорости передвижения игрока на N процентов.  
   2. Увеличение урона от всех возможных источников на N процентов.  
8. Рандомный бафф/дебафф я назвал Trickster, он тоже спаунится в safe room и даёт рандомный blessing или curse, при этом в отличие от них он ни забирает, ни дает деньги. Также следует упомянуть, что игрок может выбрать только один предмет из Blessing, Trickster и Curse, то есть если взять Curse, нельзя потом ещё взять Blessing.  
9. В сложных комнатах увеличивается кол-во ловушек, урон от ловушек и постоянный урон от времени.  
10. В пункте 3.b я уже описал, что большая награда монетами за сложную комнату является эквивалентом хилки.  
11.  Реализовал data table DT_Settings, в которой можно удобно настраивать важные игровые параметры.  
12. Реализовал систему стрельбы стрелами. Вы можете использовать стрелы, чтобы уничтожить как ни странно другите стрелы и паутину. Также можно использовать стрелы, чтобы с безопасной дистанции активировать большие шипы при попадании по их триггер платформе. Но, чтобы не сделать стрелы ультимативным способом прохождения, я добавил стоимость для их использования. То есть каждый выстрел тратит N монет.  
13. Вместо типов сложности у меня есть разное поведение стрел с разными ловушками. Например, большие шипы можно затриггерить и тогда их считай и не было, а паутину вообще можно уничтожить. Что касается установки со стрелами, то её стрелы сломать можно, но саму стреляющую платформу уничтожить нельзя, а маленькие шипы вообще хоть как-либо задеть выстрелами не выйдет.

Итог: вышла игра, где тебе надо постоянно менеджить своими монетами, они являются и жизнями, и деньгами для покупок blessings и использования стрел, и финальным счётом в игре.

# Генерация комнат

Генерация сейф рума:  
В сейф руме всегда есть 3 предмета (Blessing, Trickster и Curse), 2 кнопки для выбора следующей комнаты (обычной или сложной) и начиная с 6 пройденных комнат с ловушками есть шанс спауна зелёной кнопки, с помощью которой можно сбежать из подземелья и завершить игру.

Генерация комнат с ловушками:  
Я сделал две пустой комнаты, где спаунятся ловушки и в конце которой есть кнопка для прохода в сейф рум. У каждой комнаты есть свой room manager, в котором хранятся все спаунеры, (серые круглешки на скрине ниже) и позиция старта игрока.

![image](https://github.com/user-attachments/assets/c3d608b4-8d70-49b7-a6a0-86a5ae7b3b37)

В начале игры, каждый спаунер пускает 6 рейкастов во все стороны на небольшую дистанцию, чтобы найти позиции, где можно заспаунить ловушку, также я беру нормаль рейкаста, чтобы определить, как мне повернуть ловушку, потому что они могут спаунится на потолку, стенах и полу и их ориентация должна отличаться.  
Затем, когда игрок выбрал из сейф рума в какую комнату пойдёт, то в гейм моде я ставлю соответствующие параметры для урона и шанса спауна ловушек, затем выбираю радномный рум менеджер и заставляю его заспаунить в комнаты ловушки. Он проходит по каждой возможной позиции для спауна ловушки и с определённым шансом спаунит там случайную ловушку соответствующей ориентации, то есть на стенах могут спаунится установки со стрелами и большие шипы, на потолке только установки со стрелами, а на полу \- паутина, огненный пол, маленькие шипы и большие шипы.  
После спауна комнаты, гейммод телепортит игрока на стартовую позицию выбранной и подготовленной комнате с ловушками.

# Геймдизайнерские заметки

Я старался сделать дизайн ловушек связанным друг с другом, с комнатой и игроком, чтобы были интересные синергии и ситуации, в которых может оказаться игрок.  
Примеры:

1. Каждая комната с ловушками 2 блока (эатаж) в высоту и рост персонажа не достигает 2-ого блока, то есть ловушки расположенные на стене на 2-ом блоке по сути никак не трогают игрока. Поэтому я сделал прыжки важной опцией, чтобы были моменты, когда игрок оказывался на 2-ом этаже. Для этого я добавил ловушки, которые можно перепрыгнуть, а именно маленькие шипы и огненный пол. Это предлагают игроку вариант прыжка, но если он не будет осмотрительным, то он заденет ловушку на 2-ом этаже.  
2. В чём смысл паутины, ведь она не наносит урон? Её суть в том что она может визуально прикрывать другие ловушки (хоть она и полупрозрачная), замедлить игрока, что заставляет его проходить комнату медленнее и тратить больше монет, а также делает его более уязвимым к стрелам.  
3. Также у многих ловушек есть разные способы их преодолеть, но бывает, что они начинают конфликтовать друг с другом. Например, игрок хочет обойти большие шипы сбоку, но там стоят маленькие шипы, тогда он решает перепрыгнуть маленькие шипы, но на 2-ом этаже ещё одни большие шипы и если он прыгнет, то они активируются и ударят его. В таком случае есть 2 варианта: либо безопасно активировать большие шипы на полу с помощью выстрела, но это тратит монеты, либо попробовать их затриггереть, не задев при этом шипы, но это рискованно. Таким образом синергии ловушек заставляют игрока решать небольшие головоломки в стрессовой ситуации (монетки капают) и принимать неоднозначные решение, что делает игровой процесс более интересным.
